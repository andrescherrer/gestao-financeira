# REP-003 - Criar use case para relatório por categoria

**Data:** 2025-12-27  
**Status:** ✅ Concluída

## Resumo da Implementação

**Tarefa:** REP-003 - Criar use case para relatório por categoria

### Implementação

Criado use case completo para geração de relatórios agrupados por categoria. Como as transações ainda não possuem `category_id`, a implementação atual agrupa por tipo de transação (INCOME/EXPENSE) e está preparada para ser estendida quando `category_id` for adicionado às transações.

### Arquivos Criados

1. **`backend/internal/reporting/application/dtos/category_report_input.go`**
   - DTO de entrada com validações
   - Campos: user_id, category_id (opcional), start_date (opcional), end_date (opcional), currency (opcional)

2. **`backend/internal/reporting/application/dtos/category_report_output.go`**
   - DTO de saída com breakdown por categoria
   - Inclui: totais, contagens, breakdown por categoria com percentuais

3. **`backend/internal/reporting/application/usecases/category_report_usecase.go`**
   - Use case principal para geração de relatórios por categoria
   - Atualmente agrupa por tipo de transação (INCOME/EXPENSE)
   - Suporta filtros por período (start_date, end_date)
   - Suporta filtro opcional por moeda
   - Preparado para agrupar por categoria quando `category_id` for adicionado

4. **`backend/internal/reporting/application/usecases/category_report_usecase_test.go`**
   - Testes unitários completos
   - Testa agrupamento por tipo
   - Testa filtros por data
   - Testa validação de entrada
   - Cobertura de casos de erro

### Funcionalidades

- ✅ Geração de relatório agrupado por tipo de transação
- ✅ Cálculo de totais por tipo (INCOME/EXPENSE)
- ✅ Cálculo de percentuais
- ✅ Filtro opcional por período (start_date, end_date)
- ✅ Filtro opcional por moeda
- ✅ Contagem de transações por tipo
- ✅ Validação de entrada
- ✅ Testes unitários completos

### Nota Importante

**Status Atual:** As transações ainda não possuem `category_id` no banco de dados. A implementação atual agrupa por tipo de transação (INCOME/EXPENSE) como solução temporária.

**Preparado para Futuro:** Quando `category_id` for adicionado às transações, o use case pode ser facilmente estendido para:
- Agrupar por categoria real
- Filtrar por categoria específica
- Mostrar nome da categoria no breakdown

### Estrutura do Relatório

O relatório por categoria retorna:
- Breakdown por categoria (atualmente por tipo)
- Total de receitas
- Total de despesas
- Saldo (receitas - despesas)
- Contagem total de transações
- Percentuais de cada categoria/tipo

### Breakdown por Categoria

Cada entrada do breakdown contém:
- CategoryID (vazio por enquanto, será preenchido quando category_id for adicionado)
- CategoryName (placeholder por enquanto)
- Type (INCOME ou EXPENSE)
- TotalAmount (total do tipo/categoria)
- Count (quantidade de transações)
- Percentage (percentual do total)

### Testes

```bash
cd backend
go test ./internal/reporting/application/usecases/... -v -run TestCategoryReportUseCase
```

**Resultado:** ✅ Todos os testes passando

### Dependências

- ✅ REP-001: Use case para relatório mensal (estrutura base)

### Próximos Passos

- REP-004: Criar use case para receitas vs despesas
- **Futuro:** Adicionar `category_id` às transações e estender este use case

---

**Autor:** Sistema de Gestão Financeira  
**Data:** 2025-12-27

