# FE-009 - Criar Dockerfile para frontend

**Data:** 2025-12-23  
**Status:** ✅ Concluída

## Resumo da Implementação

**Tarefa:** FE-009 - Criar Dockerfile para frontend

### Arquivos Criados/Modificados

1. **`frontend/Dockerfile`**
   - Dockerfile multi-stage otimizado para Next.js
   - 3 estágios: deps, builder, runner
   - Usa Node.js 20 Alpine (imagem leve)
   - Usuário não-root para segurança
   - Output standalone para otimização

2. **`frontend/.dockerignore`**
   - Arquivo para ignorar arquivos desnecessários no build
   - Reduz tamanho do contexto Docker
   - Ignora node_modules, .next, arquivos de ambiente, etc.

3. **`frontend/next.config.js`**
   - Adicionado `output: 'standalone'` para otimização Docker
   - Gera build standalone mais leve

4. **`docker-compose.yml`**
   - Adicionado serviço `frontend`
   - Configuração de portas, variáveis de ambiente
   - Healthcheck configurado
   - Dependência do serviço `api`

### Estrutura do Dockerfile

#### Stage 1: Dependencies
- Instala apenas as dependências
- Usa `npm ci` para instalação limpa e rápida
- Cache otimizado

#### Stage 2: Builder
- Copia dependências do stage anterior
- Copia código fonte
- Executa `npm run build`
- Gera build de produção

#### Stage 3: Runner
- Imagem final minimalista
- Copia apenas arquivos necessários
- Usuário não-root (nextjs:nodejs)
- Expõe porta 3000
- Executa servidor standalone

### Configurações

#### Variáveis de Ambiente no Docker Compose
- `NEXT_PUBLIC_API_URL`: URL da API backend
- `NEXT_PUBLIC_ENV`: Ambiente (production)
- `NEXT_PUBLIC_APP_NAME`: Nome da aplicação
- `NEXT_PUBLIC_APP_VERSION`: Versão da aplicação

#### Portas
- Frontend: `3000` (configurável via `FRONTEND_PORT`)
- API: `8080` (já existente)

#### Healthcheck
- Verifica se o frontend está respondendo
- Intervalo: 30s
- Timeout: 10s
- Retries: 3

### Otimizações

1. **Multi-stage build**: Reduz tamanho da imagem final
2. **Standalone output**: Next.js gera build otimizado
3. **Alpine Linux**: Imagem base leve
4. **Non-root user**: Segurança aprimorada
5. **Layer caching**: Dependências em stage separado
6. **.dockerignore**: Reduz contexto de build

### Comandos Docker

#### Build
```bash
docker build -t gestao-financeira-frontend ./frontend
```

#### Run
```bash
docker run -p 3000:3000 \
  -e NEXT_PUBLIC_API_URL=http://localhost:8080/api/v1 \
  gestao-financeira-frontend
```

#### Docker Compose
```bash
docker compose up frontend
```

### Próximos Passos

Esta configuração será usada em:
- **Deploy em produção**: Container pronto para produção
- **CI/CD**: Integração contínua com Docker
- **Desenvolvimento local**: Ambiente consistente
- **Testes**: Ambiente isolado para testes

### Testes Realizados

- ✅ Dockerfile criado com multi-stage build
- ✅ `.dockerignore` configurado
- ✅ `next.config.js` atualizado com standalone output
- ✅ `docker-compose.yml` atualizado com serviço frontend
- ✅ `npm run build` - Build do projeto passou
- ✅ Configuração de variáveis de ambiente

### Melhorias Futuras

- Adicionar cache de dependências no Dockerfile
- Configurar nginx como reverse proxy
- Adicionar SSL/TLS
- Configurar CDN para assets estáticos
- Otimizar imagens com imagemin

### Próxima Tarefa

Sprint 1.8 - Módulo de Autenticação - Frontend (FE-AUTH-001)

### Commits Realizados

- `feat: FE-009 - criar Dockerfile para frontend`

