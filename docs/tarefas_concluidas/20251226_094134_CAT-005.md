# CAT-005: Criar migration para tabela categories

**Data:** 2025-12-26 09:41:34  
**Sprint:** 2.3 - Category Context - Backend  
**Status:** ✅ Completo

## Resumo

Criação da migration SQL para a tabela `categories` no PostgreSQL, incluindo estrutura da tabela, índices, foreign keys, triggers e comentários.

## Implementação

### Arquivos Criados

- `migrations/004_create_categories_table.sql`

### Estrutura da Tabela

```sql
CREATE TABLE categories (
    id UUID PRIMARY KEY,
    user_id UUID NOT NULL,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    is_active BOOLEAN NOT NULL DEFAULT true,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP NULL,
    CONSTRAINT fk_categories_user FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

### Índices Criados

- `idx_categories_user_id`: Índice em `user_id` para buscas por usuário
- `idx_categories_deleted_at`: Índice em `deleted_at` para soft delete
- `idx_categories_is_active`: Índice em `is_active` para filtros de status
- `idx_categories_user_active`: Índice composto em `(user_id, is_active)` para consultas otimizadas

### Funcionalidades

- Foreign key para `users(id)` com `ON DELETE CASCADE`
- Trigger automático para atualizar `updated_at`
- Soft delete através de `deleted_at`
- Comentários descritivos na tabela e colunas

## Padrão Seguido

Seguido o mesmo padrão usado nas migrations de `users`, `accounts` e `transactions`, garantindo consistência no banco de dados.

