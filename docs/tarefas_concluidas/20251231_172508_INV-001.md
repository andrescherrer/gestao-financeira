# INV-001: Criar value objects para Investment

**Data:** 2025-12-31  
**Tarefa:** INV-001  
**Status:** âœ… Completo  
**Tipo:** ğŸ”µ Backend | Domain

---

## ğŸ“‹ Problema

Para implementar o contexto de Investment (Investimentos), era necessÃ¡rio criar os value objects que representam os conceitos fundamentais do domÃ­nio de investimentos. Sem esses value objects, nÃ£o seria possÃ­vel criar a entidade Investment e implementar as regras de negÃ³cio relacionadas.

---

## âœ… SoluÃ§Ã£o Implementada

Foram criados 4 value objects seguindo o padrÃ£o DDD estabelecido no projeto:

1. **InvestmentID** - Identificador Ãºnico do investimento (UUID)
2. **InvestmentType** - Tipo de investimento (STOCK, FUND, CDB, TREASURY, CRYPTO, OTHER)
3. **InvestmentName** - Nome do investimento com ticker opcional
4. **InvestmentReturn** - Retorno do investimento (valor absoluto e percentual)

---

## ğŸ“ Arquivos Criados

### Value Objects
- `backend/internal/investment/domain/valueobjects/investment_id.go` - Identificador do investimento
- `backend/internal/investment/domain/valueobjects/investment_type.go` - Tipo de investimento
- `backend/internal/investment/domain/valueobjects/investment_name.go` - Nome do investimento
- `backend/internal/investment/domain/valueobjects/investment_return.go` - Retorno do investimento

### Testes
- `backend/internal/investment/domain/valueobjects/investment_id_test.go` - Testes para InvestmentID
- `backend/internal/investment/domain/valueobjects/investment_type_test.go` - Testes para InvestmentType
- `backend/internal/investment/domain/valueobjects/investment_name_test.go` - Testes para InvestmentName
- `backend/internal/investment/domain/valueobjects/investment_return_test.go` - Testes para InvestmentReturn

---

## ğŸ¯ CaracterÃ­sticas Implementadas

### 1. InvestmentID
- âœ… ValidaÃ§Ã£o de formato UUID
- âœ… GeraÃ§Ã£o automÃ¡tica de IDs
- âœ… MÃ©todos de comparaÃ§Ã£o e verificaÃ§Ã£o
- âœ… ImutÃ¡vel e type-safe

### 2. InvestmentType
- âœ… 6 tipos suportados: STOCK, FUND, CDB, TREASURY, CRYPTO, OTHER
- âœ… ValidaÃ§Ã£o de tipos vÃ¡lidos
- âœ… MÃ©todos auxiliares (IsStock, IsFund, etc.)
- âœ… MÃ©todos de domÃ­nio:
  - `RequiresQuantity()` - indica se o tipo requer quantidade
  - `HasVariableValue()` - indica se o tipo tem valor variÃ¡vel
- âœ… Display names para interface

### 3. InvestmentName
- âœ… ValidaÃ§Ã£o de nome (2-200 caracteres)
- âœ… Ticker opcional (atÃ© 20 caracteres)
- âœ… FormataÃ§Ã£o automÃ¡tica (trim de espaÃ§os)
- âœ… MÃ©todo String() que inclui ticker quando disponÃ­vel
- âœ… MÃ©todos de comparaÃ§Ã£o

### 4. InvestmentReturn
- âœ… Valor absoluto como Money (ganho/perda)
- âœ… Percentual de retorno
- âœ… MÃ©todos auxiliares (IsPositive, IsNegative, IsZero)
- âœ… FormataÃ§Ã£o para exibiÃ§Ã£o

---

## ğŸ“Š Estrutura dos Value Objects

### InvestmentID
```go
type InvestmentID struct {
    value string // UUID
}

// MÃ©todos principais:
- NewInvestmentID(id string) (InvestmentID, error)
- GenerateInvestmentID() InvestmentID
- Value() string
- Equals(other InvestmentID) bool
- IsEmpty() bool
```

### InvestmentType
```go
type InvestmentType struct {
    value string // STOCK, FUND, CDB, TREASURY, CRYPTO, OTHER
}

// MÃ©todos principais:
- NewInvestmentType(value string) (InvestmentType, error)
- Value() string
- DisplayName() string
- RequiresQuantity() bool
- HasVariableValue() bool
- IsStock(), IsFund(), IsCDB(), etc.
```

### InvestmentName
```go
type InvestmentName struct {
    name   string
    ticker *string // Opcional
}

// MÃ©todos principais:
- NewInvestmentName(name string, ticker *string) (InvestmentName, error)
- Name() string
- Ticker() *string
- HasTicker() bool
- String() string // "Name (TICKER)" ou "Name"
```

### InvestmentReturn
```go
type InvestmentReturn struct {
    absolute   Money   // Valor absoluto
    percentage float64 // Percentual
}

// MÃ©todos principais:
- NewInvestmentReturn(absolute Money, percentage float64) InvestmentReturn
- Absolute() Money
- Percentage() float64
- IsPositive() bool
- IsNegative() bool
- IsZero() bool
```

---

## âœ… Testes Implementados

### Cobertura de Testes
- âœ… **InvestmentID**: 7 testes (100% cobertura)
  - ValidaÃ§Ã£o de UUID
  - GeraÃ§Ã£o de IDs
  - ComparaÃ§Ã£o e verificaÃ§Ã£o
  
- âœ… **InvestmentType**: 8 testes (100% cobertura)
  - ValidaÃ§Ã£o de tipos
  - MÃ©todos auxiliares
  - RequiresQuantity e HasVariableValue
  
- âœ… **InvestmentName**: 6 testes (100% cobertura)
  - ValidaÃ§Ã£o de nome e ticker
  - FormataÃ§Ã£o e comparaÃ§Ã£o
  
- âœ… **InvestmentReturn**: 5 testes (100% cobertura)
  - CriaÃ§Ã£o e validaÃ§Ã£o
  - MÃ©todos auxiliares (IsPositive, IsNegative, IsZero)
  - ComparaÃ§Ã£o

**Total:** 26 testes unitÃ¡rios, todos passando âœ…

---

## ğŸ” ValidaÃ§Ãµes Implementadas

### InvestmentID
- âœ… NÃ£o pode ser vazio
- âœ… Deve ser um UUID vÃ¡lido

### InvestmentType
- âœ… Deve ser um dos tipos vÃ¡lidos (STOCK, FUND, CDB, TREASURY, CRYPTO, OTHER)
- âœ… Case-insensitive (converte para uppercase)
- âœ… Trim de espaÃ§os

### InvestmentName
- âœ… Nome: 2-200 caracteres
- âœ… Ticker: mÃ¡ximo 20 caracteres (opcional)
- âœ… Trim de espaÃ§os em ambos

### InvestmentReturn
- âœ… ValidaÃ§Ã£o implÃ­cita atravÃ©s do Money (valor absoluto)
- âœ… Percentual pode ser positivo, negativo ou zero

---

## ğŸ“ PadrÃµes Seguidos

1. **Imutabilidade**: Todos os value objects sÃ£o imutÃ¡veis
2. **ValidaÃ§Ã£o no construtor**: ValidaÃ§Ãµes ocorrem na criaÃ§Ã£o
3. **Type safety**: Uso de tipos especÃ­ficos em vez de strings primitivas
4. **MÃ©todos auxiliares**: MÃ©todos `Must*` para uso em testes
5. **ComparaÃ§Ã£o por valor**: MÃ©todo `Equals()` para comparaÃ§Ã£o
6. **String representation**: ImplementaÃ§Ã£o de `fmt.Stringer`
7. **Testes completos**: 100% de cobertura com testes unitÃ¡rios

---

## ğŸ”— DependÃªncias

- âœ… `github.com/google/uuid` - Para validaÃ§Ã£o e geraÃ§Ã£o de UUIDs
- âœ… `gestao-financeira/backend/internal/shared/domain/valueobjects` - Para Money e Currency

---

## ğŸ“ˆ PrÃ³ximos Passos

Com os value objects implementados, podemos prosseguir para:
- **INV-002**: Criar entidade Investment
- **INV-003**: Implementar repositÃ³rio e use cases
- **INV-004**: Criar handlers e rotas

---

## âœ… ValidaÃ§Ã£o

- âœ… Todos os testes passando (26 testes)
- âœ… Sem erros de lint
- âœ… Seguindo padrÃµes DDD do projeto
- âœ… DocumentaÃ§Ã£o completa
- âœ… CÃ³digo revisado e validado

---

## ğŸ“š ReferÃªncias

- [Domain-Driven Design - Value Objects](https://martinfowler.com/bliki/ValueObject.html)
- PadrÃµes estabelecidos em `backend/internal/account/domain/valueobjects`
- PadrÃµes estabelecidos em `backend/internal/transaction/domain/valueobjects`

---

**Ãšltima AtualizaÃ§Ã£o:** 2025-12-31  
**Commit:** `[hash]` - feat(investment): implementar INV-001 - value objects para Investment

