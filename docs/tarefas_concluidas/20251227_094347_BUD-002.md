# BUD-002: Criar entidade Budget (agregado raiz)

**Nota:** O value object `BudgetPeriod` foi criado junto com esta tarefa.

**Data:** 2025-12-27 09:43:47  
**Sprint:** 3.1 - Budget Context - Backend  
**Status:** ✅ Completo

## Resumo

Criação da entidade `Budget` como agregado raiz do contexto de Budget. A entidade encapsula as regras de negócio relacionadas a orçamentos e publica eventos de domínio.

## Implementação

### Arquivos Criados

- `backend/internal/budget/domain/entities/budget.go`
- `backend/internal/budget/domain/entities/budget_test.go`
- `backend/internal/budget/domain/events/budget_created.go`

### Funcionalidades

1. **NewBudget**: Cria um novo orçamento com validações
2. **BudgetFromPersistence**: Reconstrói orçamento a partir de dados persistidos
3. **UpdateAmount**: Atualiza o valor do orçamento
4. **UpdatePeriod**: Atualiza o período do orçamento
5. **Activate**: Ativa o orçamento
6. **Deactivate**: Desativa o orçamento
7. **GetEvents**: Retorna eventos de domínio
8. **ClearEvents**: Limpa eventos de domínio

### Validações

- UserID não pode ser vazio
- CategoryID não pode ser vazio
- Amount não pode ser negativo ou zero
- Currency não pode ser alterada após criação

### Eventos de Domínio

- **BudgetCreated**: Publicado quando um orçamento é criado
- **BudgetUpdated**: Publicado quando um orçamento é atualizado
- **BudgetActivated**: Publicado quando um orçamento é ativado
- **BudgetDeactivated**: Publicado quando um orçamento é desativado

### Testes

Testes unitários cobrindo:
- Criação de orçamento válido
- Validações de entrada inválida
- Atualização de valor e período
- Ativação e desativação
- Reconstrução a partir de persistência
- Verificação de eventos de domínio

## Padrão Seguido

Seguido o mesmo padrão usado em `Account`, `Transaction` e `Category`, garantindo consistência na arquitetura.

