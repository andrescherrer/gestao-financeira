# FE-TX-001 - Criar hook useTransactions (TanStack Query)

**Data:** 2025-12-23  
**Status:** ✅ Concluída

## Resumo da Implementação

**Tarefa:** FE-TX-001 - Criar hook useTransactions (TanStack Query)

### Arquivo Criado

1. **`frontend/lib/hooks/useTransactions.ts`**
   - Hook customizado para gerenciar transações com TanStack Query
   - Query para listar transações (`useTransactions`)
     - Suporta filtro opcional por `accountId`
     - Cache configurado (5 minutos staleTime, 10 minutos gcTime)
   - Query para obter transação específica por ID (`useTransaction`)
     - Query habilitada apenas quando `transactionId` está definido
   - Mutations implementadas:
     - `createTransaction`: Criar nova transação
     - `updateTransaction`: Atualizar transação existente
     - `deleteTransaction`: Deletar transação
   - Invalidação automática de cache:
     - Após criar/atualizar/deletar transação, invalida queries de transações
     - Também invalida queries de contas para atualizar saldo

### Arquivos Modificados

1. **`frontend/lib/api/transactions.ts`**
   - Ajustado para formato de resposta do backend:
     - `list()`: retorna `response.data.data` (backend retorna `{ message, data: { transactions, count } }`)
     - `getById()`: retorna `response.data.data` (backend retorna `{ message, data: {...} }`)
     - `create()`: retorna `response.data.data` (backend retorna `{ message, data: {...} }`)
     - `update()`: retorna `response.data.data` (backend retorna `{ message, data: {...} }`)

2. **`frontend/lib/api/types.ts`**
   - Atualizado tipo `Transaction.type`: removido 'TRANSFER', mantido apenas 'INCOME' | 'EXPENSE' (corresponde ao backend)
   - Atualizado `CreateTransactionRequest.type`: removido 'TRANSFER'
   - Atualizado `UpdateTransactionRequest.type`: removido 'TRANSFER'
   - Atualizado `ListTransactionsResponse`: campo `total` renomeado para `count` (corresponde ao backend)

### Funcionalidades do Hook

#### useTransactions(accountId?: string)

**Retorna:**
- `transactions`: Array de transações
- `total`: Total de transações (count)
- `isLoading`: Estado de carregamento
- `error`: Erro se houver
- `createTransaction`: Função para criar transação
- `updateTransaction`: Função para atualizar transação
- `deleteTransaction`: Função para deletar transação
- `refetchTransactions`: Função para refetch manual
- `isCreating`, `isUpdating`, `isDeleting`: Estados de loading das mutations
- `createError`, `updateError`, `deleteError`: Erros das mutations

#### useTransaction(transactionId: string | null)

**Retorna:**
- `transaction`: Dados da transação
- `isLoading`: Estado de carregamento
- `error`: Erro se houver
- `refetch`: Função para refetch manual

### Integração com API

- Hook integrado com `transactionsService`
- Tratamento do formato de resposta do backend: `{ message, data }`
- Error handling com TanStack Query
- Invalidação inteligente de cache (transações + contas)

### Testes

- TypeScript type-check passou
- Linter sem erros
- Hook pronto para uso em componentes

### Commits

- A ser commitado após todas as tarefas da sprint

### Próximos Passos

- FE-TX-002: Criar página de lista de transações
- FE-TX-003: Criar componente TransactionTable

