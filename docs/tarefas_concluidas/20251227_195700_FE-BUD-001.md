# FE-BUD-001 - Criar hook useBudgets (TanStack Query)

**Data:** 2025-12-27  
**Status:** ✅ Concluída

## Resumo da Implementação

**Tarefa:** FE-BUD-001 - Criar hook useBudgets (TanStack Query)

### Implementação

Criado hook `useBudgets` usando TanStack Query Vue para gerenciar orçamentos, incluindo:
- Instalação do @tanstack/vue-query
- Configuração do QueryClient no main.ts
- Serviço de API para budgets
- Tipos TypeScript para Budget
- Hook completo com queries e mutations

### Arquivos Criados

1. **`frontend/src/api/budgets.ts`**
   - Serviço de API para orçamentos
   - Métodos: list, get, create, update, delete, getProgress
   - Mapeamento de dados do backend para frontend

2. **`frontend/src/hooks/useBudgets.ts`**
   - Hook principal usando TanStack Query
   - Query para listar orçamentos
   - Query para obter orçamento específico
   - Query para obter progresso do orçamento
   - Mutations para criar, atualizar e deletar
   - Invalidação automática de cache

3. **`frontend/src/api/types.ts`** (modificado)
   - Tipos adicionados: Budget, CreateBudgetRequest, UpdateBudgetRequest
   - Tipos: ListBudgetsResponse, BudgetProgress

4. **`frontend/src/main.ts`** (modificado)
   - Configuração do VueQueryPlugin
   - QueryClient configurado com opções padrão

5. **`frontend/src/api/client.ts`** (modificado)
   - Correção de tipos TypeScript

### Dependências Adicionadas

- ✅ `@tanstack/vue-query` - TanStack Query para Vue 3

### Funcionalidades

- ✅ Listar orçamentos com filtros opcionais
- ✅ Obter orçamento específico
- ✅ Obter progresso do orçamento (com refetch automático)
- ✅ Criar novo orçamento
- ✅ Atualizar orçamento
- ✅ Deletar orçamento
- ✅ Cache automático com TanStack Query
- ✅ Invalidação de cache após mutations
- ✅ Estados de loading e error
- ✅ TypeScript completo

### Uso do Hook

```typescript
import { useBudgets } from '@/hooks/useBudgets'

// Listar orçamentos
const {
  budgets,
  total,
  isLoadingBudgets,
  refetchBudgets,
  createBudget,
  isCreatingBudget,
} = useBudgets({
  period_type: 'MONTHLY',
  year: 2025,
  month: 12,
})

// Obter orçamento específico
const { useBudget } = useBudgets()
const { data: budget } = useBudget(budgetId)

// Obter progresso
const { useBudgetProgress } = useBudgets()
const { data: progress } = useBudgetProgress(budgetId)

// Criar orçamento
createBudget({
  category_id: 'xxx',
  amount: 1000,
  currency: 'BRL',
  period_type: 'MONTHLY',
  year: 2025,
  month: 12,
  context: 'PERSONAL',
})
```

### Configuração do TanStack Query

**QueryClient:**
- Retry: 1 tentativa
- Refetch on window focus: desabilitado
- Stale time: 5 minutos

**Budget Progress:**
- Refetch automático a cada 60 segundos

### Dependências

- ✅ FE-007: TanStack Query instalado e configurado

### Próximos Passos

- FE-BUD-002: Criar página de dashboard de orçamentos (/budget)

---

**Autor:** Sistema de Gestão Financeira  
**Data:** 2025-12-27

