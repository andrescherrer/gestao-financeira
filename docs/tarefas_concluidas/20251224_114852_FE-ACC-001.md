# FE-ACC-001: Criar store Pinia para contas (useAccountsStore)

**Data de Conclus√£o:** 2025-12-24  
**Sprint:** 1.9 - M√≥dulo de Contas - Frontend  
**Status:** ‚úÖ Conclu√≠do

---

## üìã Resumo

Cria√ß√£o do store Pinia `useAccountsStore` para gerenciar o estado das contas no frontend Vue 3, incluindo servi√ßo de API, fun√ß√µes para listar, criar e obter contas, e gerenciamento de estados de loading e erro.

---

## üéØ Objetivo

Implementar um store Pinia centralizado para gerenciar todo o estado relacionado a contas, seguindo o mesmo padr√£o do `useAuthStore`, facilitando o acesso e manipula√ß√£o de dados de contas em toda a aplica√ß√£o.

---

## ‚úÖ Implementa√ß√£o

### 1. **Servi√ßo de API de Contas** (`src/api/accounts.ts`)

**Funcionalidades:**
- `list(context?)`: Lista todas as contas do usu√°rio autenticado (opcionalmente filtrado por contexto)
- `get(accountId)`: Obt√©m detalhes de uma conta espec√≠fica
- `create(data)`: Cria uma nova conta

**Caracter√≠sticas:**
- Usa `apiClient` configurado (com interceptors de autentica√ß√£o)
- Tipado com TypeScript
- Tratamento de erros via try/catch

### 2. **Store Pinia** (`src/stores/accounts.ts`)

**Estado:**
- `accounts`: Array de contas
- `currentAccount`: Conta atualmente selecionada
- `isLoading`: Estado de carregamento
- `error`: Mensagem de erro

**Computed Properties:**
- `totalAccounts`: Total de contas
- `activeAccounts`: Contas ativas
- `personalAccounts`: Contas pessoais
- `businessAccounts`: Contas de neg√≥cio

**A√ß√µes:**
- `listAccounts(context?)`: Lista contas (com filtro opcional por contexto)
- `getAccount(accountId)`: Obt√©m detalhes de uma conta
- `createAccount(data)`: Cria uma nova conta
- `clearError()`: Limpa mensagem de erro
- `clearCurrentAccount()`: Limpa conta atual

**Caracter√≠sticas:**
- Gerenciamento autom√°tico de loading states
- Tratamento de erros com mensagens amig√°veis
- Atualiza√ß√£o autom√°tica da lista ao obter detalhes
- Integra√ß√£o com `useAuthStore` para contexto do usu√°rio

---

## üìÅ Estrutura de Arquivos

```
frontend/src/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ accounts.ts      ‚úÖ Novo (servi√ßo de API)
‚îî‚îÄ‚îÄ stores/
    ‚îî‚îÄ‚îÄ accounts.ts       ‚úÖ Novo (store Pinia)
```

---

## üîß Integra√ß√£o com API

### Endpoints Utilizados

1. **GET /accounts**
   - Lista todas as contas do usu√°rio
   - Query params opcionais: `context` (PERSONAL | BUSINESS)
   - Resposta: `{ accounts: Account[], count: number }`

2. **GET /accounts/:id**
   - Obt√©m detalhes de uma conta
   - Resposta: `Account`

3. **POST /accounts**
   - Cria uma nova conta
   - Body: `CreateAccountRequest`
   - Resposta: `Account`

### Tipos TypeScript

```typescript
interface Account {
  account_id: string
  user_id: string
  name: string
  type: 'BANK' | 'WALLET' | 'INVESTMENT' | 'CREDIT_CARD'
  balance: string
  currency: 'BRL' | 'USD' | 'EUR'
  context: 'PERSONAL' | 'BUSINESS'
  is_active: boolean
  created_at: string
  updated_at: string
}

interface CreateAccountRequest {
  name: string
  type: 'BANK' | 'WALLET' | 'INVESTMENT' | 'CREDIT_CARD'
  initial_balance?: string
  currency?: 'BRL' | 'USD' | 'EUR'
  context: 'PERSONAL' | 'BUSINESS'
}
```

---

## ‚úÖ Testes

### Testes Manuais Realizados
- ‚úÖ Store criado sem erros de TypeScript
- ‚úÖ Servi√ßo de API criado sem erros
- ‚úÖ Linter passou sem erros
- ‚úÖ Estrutura segue padr√£o do `useAuthStore`

---

## üöÄ Pr√≥ximos Passos

1. **FE-ACC-002:** Criar p√°gina de lista de contas (/accounts)
2. **FE-ACC-003:** Criar componente AccountCard
3. **FE-ACC-004:** Criar p√°gina de detalhes da conta
4. **FE-ACC-005:** Criar p√°gina de cria√ß√£o de conta

---

## üìù Notas T√©cnicas

### Decis√µes de Design
1. **Separa√ß√£o de responsabilidades:** Servi√ßo de API separado do store
2. **Reatividade:** Uso de `ref` e `computed` para estado reativo
3. **Tratamento de erros:** Mensagens de erro amig√°veis e centralizadas
4. **Loading states:** Gerenciamento autom√°tico de estados de carregamento
5. **Atualiza√ß√£o autom√°tica:** Lista atualizada ao obter detalhes de uma conta

### Melhorias Futuras
- Adicionar cache de contas
- Implementar pagina√ß√£o
- Adicionar filtros avan√ßados
- Implementar atualiza√ß√£o e exclus√£o de contas

---

**Tarefa conclu√≠da com sucesso!** ‚úÖ

