# TX-007 - Criar migration para tabela transactions

**Data:** 2025-12-23  
**Status:** ✅ Concluída

## Resumo da Implementação

**Tarefa:** TX-007 - Criar migration para tabela transactions

### Arquivos Criados

1. **`003_create_transactions_table.sql`** - Migration SQL:
   - Criação da tabela `transactions`
   - Campos: id, user_id, account_id, type, amount, currency, description, date
   - Timestamps: created_at, updated_at, deleted_at (soft delete)
   - Foreign keys para `users` e `accounts`
   - Check constraints para validação
   - Índices para otimização
   - Trigger para atualização automática de `updated_at`

### Estrutura da Tabela

- **id**: UUID (primary key)
- **user_id**: UUID (foreign key para users)
- **account_id**: UUID (foreign key para accounts)
- **type**: VARCHAR(20) - INCOME ou EXPENSE
- **amount**: BIGINT - valor em centavos
- **currency**: VARCHAR(3) - código da moeda (BRL, USD, EUR)
- **description**: VARCHAR(500) - descrição da transação
- **date**: DATE - data da transação
- **created_at**: TIMESTAMP
- **updated_at**: TIMESTAMP
- **deleted_at**: TIMESTAMP (soft delete)

### Constraints

- **Foreign Keys**:
  - `fk_transactions_user_id` → `users(id)` ON DELETE CASCADE
  - `fk_transactions_account_id` → `accounts(id)` ON DELETE CASCADE

- **Check Constraints**:
  - `chk_transactions_type`: type IN ('INCOME', 'EXPENSE')
  - `chk_transactions_currency`: currency IN ('BRL', 'USD', 'EUR')
  - `chk_transactions_amount`: amount > 0

### Índices Criados

- `idx_transactions_user_id` - busca por usuário
- `idx_transactions_account_id` - busca por conta
- `idx_transactions_user_id_account_id` - busca combinada
- `idx_transactions_user_id_type` - busca por usuário e tipo
- `idx_transactions_date` - busca por data
- `idx_transactions_deleted_at` - soft delete

### Trigger

- `update_transactions_updated_at` - atualiza automaticamente `updated_at` antes de UPDATE

### Commits Realizados

- `feat: TX-007 - criar migration para tabela transactions`

### Próxima Tarefa

TX-008 - Implementar CreateTransactionUseCase

